<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>跨域 | 夏洛特的博客</title>
    <meta name="description" content="我的个人博客">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/myblog/logo.png">
  <link rel="manifest" href="/myblog/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/myblog/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/myblog/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.59679289.css" as="style"><link rel="preload" href="/myblog/assets/js/app.2dc899dd.js" as="script"><link rel="preload" href="/myblog/assets/js/6.436ea9ec.js" as="script"><link rel="preload" href="/myblog/assets/js/2.c5641ed6.js" as="script"><link rel="preload" href="/myblog/assets/js/19.7f111b17.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.69719587.js"><link rel="prefetch" href="/myblog/assets/js/11.97615f58.js"><link rel="prefetch" href="/myblog/assets/js/12.a35b8877.js"><link rel="prefetch" href="/myblog/assets/js/13.37e2b90f.js"><link rel="prefetch" href="/myblog/assets/js/14.c7b2e4e0.js"><link rel="prefetch" href="/myblog/assets/js/15.ee7ccbbe.js"><link rel="prefetch" href="/myblog/assets/js/16.e8faca68.js"><link rel="prefetch" href="/myblog/assets/js/17.8cf87dd3.js"><link rel="prefetch" href="/myblog/assets/js/18.78c39740.js"><link rel="prefetch" href="/myblog/assets/js/20.54b83217.js"><link rel="prefetch" href="/myblog/assets/js/21.8f0fce3d.js"><link rel="prefetch" href="/myblog/assets/js/22.3d199b82.js"><link rel="prefetch" href="/myblog/assets/js/23.103bdb77.js"><link rel="prefetch" href="/myblog/assets/js/24.ae83ebc8.js"><link rel="prefetch" href="/myblog/assets/js/25.586f29e4.js"><link rel="prefetch" href="/myblog/assets/js/26.a522a18d.js"><link rel="prefetch" href="/myblog/assets/js/27.a0740a6c.js"><link rel="prefetch" href="/myblog/assets/js/28.73cbfe72.js"><link rel="prefetch" href="/myblog/assets/js/29.39fe4f2b.js"><link rel="prefetch" href="/myblog/assets/js/3.bf8b1e09.js"><link rel="prefetch" href="/myblog/assets/js/30.acd11f91.js"><link rel="prefetch" href="/myblog/assets/js/4.7bb159d6.js"><link rel="prefetch" href="/myblog/assets/js/5.5a6ca5b8.js"><link rel="prefetch" href="/myblog/assets/js/7.66e4e1d4.js"><link rel="prefetch" href="/myblog/assets/js/8.823aa727.js"><link rel="prefetch" href="/myblog/assets/js/9.e65b30a3.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.59679289.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">夏洛特的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/myblog/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/myblog/css/" class="nav-link">
  Css
</a></div><div class="nav-item"><a href="/myblog/js/" class="nav-link">
  Javascript
</a></div><div class="nav-item"><a href="/myblog/ts/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/myblog/http/" class="nav-link router-link-active">
  Http
</a></div><div class="nav-item"><a href="/myblog/mark/" class="nav-link">
  随笔
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/51b10c899397" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5aba05faf265da238c3ab3c1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/tinaawang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/myblog/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/myblog/css/" class="nav-link">
  Css
</a></div><div class="nav-item"><a href="/myblog/js/" class="nav-link">
  Javascript
</a></div><div class="nav-item"><a href="/myblog/ts/" class="nav-link">
  TypeScript
</a></div><div class="nav-item"><a href="/myblog/http/" class="nav-link router-link-active">
  Http
</a></div><div class="nav-item"><a href="/myblog/mark/" class="nav-link">
  随笔
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/51b10c899397" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5aba05faf265da238c3ab3c1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/tinaawang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Http</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/http/" class="sidebar-link">Cookie</a></li><li><a href="/myblog/http/access.html" class="sidebar-link">http常用请求头</a></li><li><a href="/myblog/http/connection.html" class="sidebar-link">http 长连接  短连接</a></li><li><a href="/myblog/http/cros.html" class="active sidebar-link">跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/http/cros.html#jsonp" class="sidebar-link">JSONP</a></li><li class="sidebar-sub-header"><a href="/myblog/http/cros.html#window-postmessage" class="sidebar-link">window.postMessage</a></li><li class="sidebar-sub-header"><a href="/myblog/http/cros.html#document-domain" class="sidebar-link">document.domain</a></li><li class="sidebar-sub-header"><a href="/myblog/http/cros.html#cros" class="sidebar-link">CROS</a></li><li class="sidebar-sub-header"><a href="/myblog/http/cros.html#nginx-反向代理" class="sidebar-link">Nginx 反向代理</a></li></ul></li><li><a href="/myblog/http/statusCode.html" class="sidebar-link">http状态码</a></li><li><a href="/myblog/http/tcp.html" class="sidebar-link">TCP协议</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="跨域问题"><a href="#跨域问题" class="header-anchor">#</a> 跨域问题</h1> <p>前端打工仔面试时经常遇到的跨域问题 到底什么是跨域呢？</p> <p>出现跨域这个词 首先是因为<a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener noreferrer">浏览器的同源限制策略<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。
浏览器规定只有 <strong>端口,协议 ，域名</strong>都一致才属于同源，可以互相访问</p> <p>下图给出了不同源的结果</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
URL                                      	结果	原因
http://store.company.com/dir2/other.html	同源	只有路径不同
http://store.company.com/dir/inner/another.html	同源	只有路径不同
https://store.company.com/secure.html	         失败	协议不同
http://store.company.com:81/dir/etc.html	失败	端口不同 ( http:// 默认端口是80)
http://news.company.com/dir/other.html   	失败	主机不同
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>小朋友 你是否有很多问号 跨域原来是浏览器的锅 为什么一定要限制同源才能互相访问呢？</p> <p>如果没有限制同源访问 一些钓鱼网站可以读取你的 cookie 信息 伪造身份向其他浏览器发送请求 也就是我们常说的 csrf 攻击。</p> <h3 id="解决跨域的常用方法"><a href="#解决跨域的常用方法" class="header-anchor">#</a> 解决跨域的常用方法</h3> <h2 id="jsonp"><a href="#jsonp" class="header-anchor">#</a> JSONP</h2> <p>JSONP 这个名字听起来好像和 JSON 有很大关系 其实并没有。实质上就是通过动态插入 script 标签 通过 src 路径去访问跨域的地址 参数上带上要执行的回调函数 然后通过解析响应得到想要的信息。</p> <p>这种做法有限制就是只能发送 GET 请求。那 img 标签的 src 可以用吗？别问，问就是不行，因为只有 script 标签可以解析响应。</p> <p>实现如下： 具体可以参考我的另一篇文章<a href="https://www.jianshu.com/p/c6c221f825db" target="_blank" rel="noopener noreferrer">JSONP 是什么<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  let functionName = 'tina'+parseInt(Math.random()*100000,10);
//给调用函数创建一个随机的函数名
  script.src = 'http://u.com:8002/pay?callback=' + functionName;
//u.com为响应网站的域名，8002为响应网站的端口号

window[callback] = function(result){ //定义函数
            if(result === 'success'){
                amount.innerText = amount.innerText - 1;
            }
        }
        script.onload = function(e){
            e.currentTarget.remove();//执行结束删除script标签
            delete window[callback]; //执行结束删除函数
        }
        script.onerror = function (e) {
            alert('fail');
            e.currentTarget.remove();//执行结束删除script标签
            delete window[callback];//执行结束删除函数
        }
    })
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="window-postmessage"><a href="#window-postmessage" class="header-anchor">#</a> window.postMessage</h2> <p>MDN 上的定义<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer">window.postMessage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>从广义上讲，一个窗口可以获得对另一个窗口的引用（比如 targetWindow = window.opener），然后在窗口上调用 targetWindow.postMessage() 方法分发一个 MessageEvent 消息。接收消息的窗口可以根据需要自由处理此事件。传递给 window.postMessage() 的参数（比如 message ）将通过消息事件对象暴露给接收消息的窗口。</p> <p>语法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>otherWindow.postMessage(message, targetOrigin, [transfer]);
// targetOrigin属性规定了哪些窗口可以接收到消息

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>/*
 * A窗口的域名是&lt;http://example.com:8080&gt;，以下是A窗口的script标签下的代码：
 */

var popup = window.open(...popup details...);

// 如果弹出框没有被阻止且加载完成

// 这行语句没有发送信息出去，即使假设当前页面没有改变location（因为targetOrigin设置不对）
popup.postMessage(&quot;The user is 'bob' and the password is 'secret'&quot;,
                  &quot;https://secure.example.net&quot;);

// 假设当前页面没有改变location，这条语句会成功添加message到发送队列中去（targetOrigin设置对了）
popup.postMessage(&quot;hello there!&quot;, &quot;http://example.org&quot;);

function receiveMessage(event)
{
  // 我们能相信信息的发送者吗?  (也许这个发送者和我们最初打开的不是同一个页面).
  if (event.origin !== &quot;http://example.org&quot;)
    return;

  // event.source 是我们通过window.open打开的弹出页面 popup
  // event.data 是 popup发送给当前页面的消息 &quot;hi there yourself!  the secret response is: rheeeeet!&quot;
}
window.addEventListener(&quot;message&quot;, receiveMessage, false);


/*
 * 弹出页 popup 域名是&lt;http://example.org&gt;，以下是script标签中的代码:
 */

//当A页面postMessage被调用后，这个function被addEventListenner调用
function receiveMessage(event)
{
  // 我们能信任信息来源吗？
  if (event.origin !== &quot;http://example.com:8080&quot;)
    return;

  // event.source 就当前弹出页的来源页面
  // event.data 是 &quot;hello there!&quot;

  // 假设你已经验证了所受到信息的origin (任何时候你都应该这样做), 一个很方便的方式就是把event.source
  // 作为回信的对象，并且把event.origin作为targetOrigin
  event.source.postMessage(&quot;hi there yourself!  the secret response &quot; +
                           &quot;is: rheeeeet!&quot;,
                           event.origin);
}

window.addEventListener(&quot;message&quot;, receiveMessage, false);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>postMessage 在使用的过程中如果没有指定 origin 去验证发消息的窗口是否合法是很危险的 同时也需要验证接收到的内容是否对站点是否构成攻击</p> <h2 id="document-domain"><a href="#document-domain" class="header-anchor">#</a> document.domain</h2> <p>这种方式只适合主域名相同，但子域名不同的 iframe 跨域。比如主域名是http://crosdomain.com:9099，子域名是http://child.crosdomain.com:9099，这种情况下给两个页面指定一下document.domain即document.domain = crosdomain.com 就可以访问各自的 window 对象了。</p> <h2 id="cros"><a href="#cros" class="header-anchor">#</a> CROS</h2> <p>CORS 是一个 W3C 标准，全称是&quot;跨域资源共享&quot;（Cross-origin resource sharing）这里可以参考<a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener noreferrer">阮一峰老师的文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>cros 跨域请求分为简单请求和非简单请求</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>（1) 请求方法是以下三种方法之一：

HEAD
GET
POST
（2）HTTP的头信息不超出以下几种字段：

Accept
Accept-Language
Content-Language
Last-Event-ID
Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>对于简单的请求只需要在请求头添加上 origin 标示自己身份 后端添加上 Access-Control-Allow-Origin 标示同意这个身份访问;</p> <p>如果需要发送 cookie 则需要前后端都设置 Access-Control-Allow-Credentials</p> <p>对于非简单请求 会先发送一个预请求 检查请求头成功后返回 204 然后再触发第二次请求</p> <h2 id="nginx-反向代理"><a href="#nginx-反向代理" class="header-anchor">#</a> Nginx 反向代理</h2> <p>前端请求以本地路径路径进行访问 发送请求到 Nginx 服务器上 再以真实的域名广播到请求服务器上 这一层代理之后就不存在跨域问题了 。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">4/15/2020, 1:04:04 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/myblog/http/connection.html" class="prev">
        http 长连接  短连接
      </a></span> <span class="next"><a href="/myblog/http/statusCode.html">
        http状态码
      </a>
      →
    </span></p></div>  <!----></main></div><div class="global-ui"></div></div>
    <script src="/myblog/assets/js/app.2dc899dd.js" defer></script><script src="/myblog/assets/js/6.436ea9ec.js" defer></script><script src="/myblog/assets/js/2.c5641ed6.js" defer></script><script src="/myblog/assets/js/19.7f111b17.js" defer></script>
  </body>
</html>
